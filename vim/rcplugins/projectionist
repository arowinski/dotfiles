Plug 'tpope/vim-projectionist'

fun! s:try_save_before()
  if filereadable(expand("%")) || !expand('%')
    echo "No Alternate"
  else
    exec ":w|e"
    exec s:alternate()
  endif
endfun

fun! s:open_alternate(projections)
  if(len(a:projections[-1]) == 1)
    exec 'vs' a:projections[-1][-1]
  else
    AV
  endif
endfun

fun! s:alternate()
  let projections = projectionist#query('alternate')

  if(len(projections) == 0)
    call s:try_save_before()
  else
    call s:open_alternate(projections[-1])
  endif
endfun

command! ROV silent only|RV
command! AOV silent only|call s:alternate()

noremap <Leader>av :AOV<cr>
noremap <Leader>rv :ROV<cr>

autocmd User ProjectionistDetect :call projections#set_projections(&filetype)

" vim:ft=vim
